diff --git a/node_modules/perfume.js/dist/perfume.es5.min.js b/node_modules/perfume.js/dist/perfume.es5.min.js
index 73685b0..a01f94b 100644
--- a/node_modules/perfume.js/dist/perfume.es5.min.js
+++ b/node_modules/perfume.js/dist/perfume.es5.min.js
@@ -1,2 +1,2 @@
-import"first-input-delay";var BrowserInfo=function(){return function(t,e,i){this.name=t,this.version=e,this.os=i}}(),NodeInfo=function(){return function(t){this.version=t,this.name="node",this.os=process.platform}}(),BotInfo=function(){return function(){this.bot=!0,this.name="bot",this.version=null,this.os=null}}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",SEARCHBOT_OS_REGEX]];function detect(){return"undefined"!=typeof navigator?parseUserAgent(navigator.userAgent):getNodeVersion()}function parseUserAgent(t){var e=""!==t&&userAgentRules.reduce(function(e,i){var n=i[0],r=i[1];if(e)return e;var s=r.exec(t);return!!s&&[n,s]},!1);if(!e)return null;var i=e[0],n=e[1];if("searchbot"===i)return new BotInfo;var r=n[1]&&n[1].split(/[._]/).slice(0,3);return r?r.length<REQUIRED_VERSION_PARTS&&(r=r.concat(new Array(REQUIRED_VERSION_PARTS-r.length).fill("0"))):r=[],new BrowserInfo(i,r.join("."),detectOS(t))}function detectOS(t){var e=operatingSystemRules.find(function(e){e[0];return e[1].test(t)});return e?e[0]:null}function getNodeVersion(){return"undefined"!=typeof process&&process.version?new NodeInfo(process.version.slice(1)):null}var now=function(){return+new Date},supportsRequestIdleCallback_="function"==typeof window.requestIdleCallback,IdleDealine=function(){function t(t){this.initTime_=t}return Object.defineProperty(t.prototype,"didTimeout",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.timeRemaining=function(){return Math.max(0,50-(now()-this.initTime_))},t}(),requestIdleCallbackShim=function(t){var e=new IdleDealine(now());return setTimeout(function(){return t(e)},0)},cancelIdleCallbackShim=function(t){clearTimeout(t)},rIC=supportsRequestIdleCallback_?window.requestIdleCallback:requestIdleCallbackShim,cIC=supportsRequestIdleCallback_?window.cancelIdleCallback:cancelIdleCallbackShim,createQueueMicrotaskViaPromises=function(){return function(t){Promise.resolve().then(t)}},createQueueMicrotaskViaMutationObserver=function(){var t=0,e=[],i=new MutationObserver(function(){e.forEach(function(t){return t()}),e=[]}),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(i){e.push(i),n.data=String(++t%2)}},queueMicrotask="function"==typeof Promise&&Promise.toString().indexOf("[native code]")>-1?createQueueMicrotaskViaPromises():createQueueMicrotaskViaMutationObserver(),DEFAULT_MIN_TASK_TIME=0,isSafari_=!("object"!=typeof window.safari||!window.safari.pushNotification),IdleQueue=function(){function t(t){var e=void 0===t?{}:t,i=e.ensureTasksRun,n=void 0!==i&&i,r=e.defaultMinTaskTime,s=void 0===r?DEFAULT_MIN_TASK_TIME:r;this.taskQueue_=[],this.isProcessing_=!1,this.state_=null,this.idleCallbackHandle_=null,this.taskQueue_=[],this.isProcessing_=!1,this.state_=null,this.defaultMinTaskTime_=s,this.ensureTasksRun_=n,this.runTasksImmediately=this.runTasksImmediately.bind(this),this.runTasks_=this.runTasks_.bind(this),this.onVisibilityChange_=this.onVisibilityChange_.bind(this),this.ensureTasksRun_&&(addEventListener("visibilitychange",this.onVisibilityChange_,!0),isSafari_&&addEventListener("beforeunload",this.runTasksImmediately,!0))}return t.prototype.pushTask=function(t){this.addTask_(Array.prototype.push,t)},t.prototype.unshiftTask=function(t){this.addTask_(Array.prototype.unshift,t)},t.prototype.runTasksImmediately=function(){this.runTasks_()},t.prototype.hasPendingTasks=function(){return this.taskQueue_.length>0},t.prototype.clearPendingTasks=function(){this.taskQueue_=[],this.cancelScheduledRun_()},t.prototype.getState=function(){return this.state_},t.prototype.destroy=function(){this.taskQueue_=[],this.cancelScheduledRun_(),this.ensureTasksRun_&&(removeEventListener("visibilitychange",this.onVisibilityChange_,!0),isSafari_&&removeEventListener("beforeunload",this.runTasksImmediately,!0))},t.prototype.addTask_=function(t,e,i){var n=(void 0===i?{}:i).minTaskTime,r=void 0===n?this.defaultMinTaskTime_:n,s={time:now(),visibilityState:document.visibilityState};t.call(this.taskQueue_,{state:s,task:e,minTaskTime:r}),this.scheduleTasksToRun_()},t.prototype.scheduleTasksToRun_=function(){this.ensureTasksRun_&&"hidden"===document.visibilityState?queueMicrotask(this.runTasks_):this.idleCallbackHandle_||(this.idleCallbackHandle_=rIC(this.runTasks_))},t.prototype.runTasks_=function(t){if(this.cancelScheduledRun_(),!this.isProcessing_){for(this.isProcessing_=!0;this.hasPendingTasks()&&!shouldYield(t,this.taskQueue_[0].minTaskTime);){var e=this.taskQueue_.shift(),i=e.task,n=e.state;this.state_=n,i(n),this.state_=null}this.isProcessing_=!1,this.hasPendingTasks()&&this.scheduleTasksToRun_()}},t.prototype.cancelScheduledRun_=function(){cIC(this.idleCallbackHandle_),this.idleCallbackHandle_=null},t.prototype.onVisibilityChange_=function(){"hidden"===document.visibilityState&&this.runTasksImmediately()},t}(),shouldYield=function(t,e){return!!(t&&t.timeRemaining()<=e)},EmulatedPerformance=function(){function t(t){this.config=t}return t.prototype.now=function(){return Date.now()/1e3},t.prototype.mark=function(t,e){},t.prototype.measure=function(t,e){return this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){var e=this;setTimeout(function(){t(e.getFirstPaint())})},t.prototype.getDurationByMetric=function(t,e){return e.end-e.start||0},t.prototype.getFirstPaint=function(){var t=window.performance.timing,e={duration:0,entryType:"paint",name:"first-contentful-paint",startTime:0};return t&&0!==t.navigationStart&&(e.startTime=Date.now()-t.navigationStart),[e]},t}(),Performance=function(){function t(t){this.config=t}return t.supported=function(){return window.performance&&!!performance.now&&!!performance.mark},t.supportedPerformanceObserver=function(){return window.chrome&&"PerformanceObserver"in window},t.prototype.now=function(){return window.performance.now()},t.prototype.mark=function(t,e){var i="mark_"+t+"_"+e;window.performance.mark(i)},t.prototype.measure=function(t,e){var i="mark_"+t+"_start",n="mark_"+t+"_end";return window.performance.measure(t,i,n),this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){this.perfObserver=new PerformanceObserver(this.performanceObserverCb.bind(this,t)),this.perfObserver.observe({entryTypes:["paint"]})},t.prototype.getDurationByMetric=function(t,e){var i=this.getMeasurementForGivenName(t);return i&&"measure"===i.entryType?i.duration:-1},t.prototype.getMeasurementForGivenName=function(t){var e=window.performance.getEntriesByName(t);return e[e.length-1]},t.prototype.performanceObserverCb=function(t,e){var i=this,n=e.getEntries();t(n),n.forEach(function(t){i.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&i.perfObserver.disconnect()})},t}(),Perfume=function(){function t(t){void 0===t&&(t={});var e=this;this.config={firstContentfulPaint:!1,firstPaint:!1,firstInputDelay:!1,googleAnalytics:{enable:!1,timingVar:"name"},browserTracker:!1,logPrefix:"Perfume.js:",logging:!0,maxMeasureTime:15e3,warning:!1,debugging:!1},this.firstPaintDuration=0,this.firstContentfulPaintDuration=0,this.firstInputDelayDuration=0,this.isHidden=!1,this.logMetricWarn="Please provide a metric name",this.metrics=new Map,this.observers=new Map,this.didVisibilityChange=function(){document.hidden&&(e.isHidden=document.hidden)},this.config=Object.assign({},this.config,t),this.perf=Performance.supported()?new Performance(this.config):new EmulatedPerformance(this.config),this.config.browserTracker&&(this.browser=detect()),Performance.supportedPerformanceObserver()||(this.perfEmulated=new EmulatedPerformance(this.config)),(this.config.firstPaint||this.config.firstContentfulPaint)&&(this.observeFirstContentfulPaint=new Promise(function(t){e.logDebug("observeFirstContentfulPaint"),e.observers.set("fcp",t),e.initFirstPaint()})),this.config.firstInputDelay&&(this.observeFirstInputDelay=new Promise(function(t){e.observers.set("fid",t),e.initFirstInputDelay()})),this.onVisibilityChange(),this.queue=new IdleQueue({ensureTasksRun:!0})}return t.prototype.start=function(t){this.checkMetricName(t)&&(this.metrics.has(t)?this.logWarn(this.config.logPrefix,"Recording already started."):(this.metrics.set(t,{end:0,start:this.perf.now()}),this.perf.mark(t,"start"),this.isHidden=!1))},t.prototype.end=function(t){var e=this;if(this.checkMetricName(t)){var i=this.metrics.get(t);if(i){i.end=this.perf.now(),this.perf.mark(t,"end");var n=this.perf.measure(t,i),r=parseFloat(n.toFixed(2));return this.metrics.delete(t),this.queue.pushTask(function(){e.log(t,r),e.sendTiming(t,r)}),r}this.logWarn(this.config.logPrefix,"Recording already stopped.")}},t.prototype.endPaint=function(t){var e=this;return new Promise(function(i){setTimeout(function(){var n=e.end(t);i(n)})})},t.prototype.log=function(t,e){if(!this.isHidden&&this.config.logging)if(t){var i=e.toFixed(2),n="%c "+this.config.logPrefix+" "+t+" "+i+" ms";window.console.log(n,"color: #ff6d00;font-size:11px;")}else this.logWarn(this.config.logPrefix,this.logMetricWarn)},t.prototype.logDebug=function(t,e){void 0===e&&(e=""),this.config.debugging&&window.console.log("Perfume.js debugging "+t+":",e)},t.prototype.sendTiming=function(t,e){if(!this.isHidden){var i=this.config.browserTracker?this.browser:void 0,n=this.addBrowserToMetricName(t);if(this.config.analyticsTracker&&this.config.analyticsTracker(t,e,i),this.config.googleAnalytics.enable)if(window.ga){var r=Math.round(e);window.ga("send","timing",n,this.config.googleAnalytics.timingVar,r)}else this.logWarn(this.config.logPrefix,"Google Analytics has not been loaded")}},t.prototype.addBrowserToMetricName=function(t){if(!this.config.browserTracker)return t;var e=t;this.browser.name&&(e+="."+this.browser.name.replace(/\s/g,""),this.browser.os&&(e+="."+this.browser.os.replace(/\s/g,"")));return e},t.prototype.checkMetricName=function(t){return!!t||(this.logWarn(this.config.logPrefix,this.logMetricWarn),!1)},t.prototype.firstContentfulPaintCb=function(t){var e=this;this.logDebug("firstContentfulPaintCb",t),t.forEach(function(t){e.queue.pushTask(function(){e.config.firstPaint&&"first-paint"===t.name&&e.logMetric(t.startTime,"First Paint","firstPaint"),e.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&e.logMetric(t.startTime,"First Contentful Paint","firstContentfulPaint")})})},t.prototype.initFirstPaint=function(){if(this.logDebug("initFirstPaint"),Performance.supportedPerformanceObserver()){this.logDebug("initFirstPaint.supportedPerformanceObserver");try{this.perf.firstContentfulPaint(this.firstContentfulPaintCb.bind(this))}catch(t){this.logWarn(this.config.logPrefix,"initFirstPaint failed")}}else this.perfEmulated&&(this.logDebug("initFirstPaint.perfEmulated"),this.perfEmulated.firstContentfulPaint(this.firstContentfulPaintCb.bind(this)))},t.prototype.initFirstInputDelay=function(){var t=this;Performance.supported()&&this.config.firstInputDelay&&perfMetrics.onFirstInputDelay(function(e,i){t.queue.pushTask(function(){t.logMetric(e,"First Input Delay","firstInputDelay")})})},t.prototype.onVisibilityChange=function(){void 0!==document.hidden&&document.addEventListener("visibilitychange",this.didVisibilityChange)},t.prototype.logMetric=function(t,e,i){var n=parseFloat(t.toFixed(2));n>this.config.maxMeasureTime||("firstPaint"===i&&(this.firstPaintDuration=n),"firstContentfulPaint"===i&&(this.firstContentfulPaintDuration=n,this.observers.get("fcp")(n)),"firstInputDelay"===i&&(this.firstInputDelayDuration=n,this.observers.get("fid")(n)),this.log(e,n),this.sendTiming(i,n))},t.prototype.logWarn=function(t,e){this.config.warning&&this.config.logging&&window.console.warn(t,e)},t}();export default Perfume;
+import"first-input-delay";var BrowserInfo=function(){return function(t,e,i){this.name=t,this.version=e,this.os=i}}(),NodeInfo=function(){return function(t){this.version=t,this.name="node",this.os=process.platform}}(),BotInfo=function(){return function(){this.bot=!0,this.name="bot",this.version=null,this.os=null}}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",SEARCHBOT_OS_REGEX]];function detect(){return"undefined"!=typeof navigator?parseUserAgent(navigator.userAgent):getNodeVersion()}function parseUserAgent(t){var e=""!==t&&userAgentRules.reduce(function(e,i){var n=i[0],r=i[1];if(e)return e;var s=r.exec(t);return!!s&&[n,s]},!1);if(!e)return null;var i=e[0],n=e[1];if("searchbot"===i)return new BotInfo;var r=n[1]&&n[1].split(/[._]/).slice(0,3);return r?r.length<REQUIRED_VERSION_PARTS&&(r=r.concat(new Array(REQUIRED_VERSION_PARTS-r.length).fill("0"))):r=[],new BrowserInfo(i,r.join("."),detectOS(t))}function detectOS(t){var e=operatingSystemRules.find(function(e){e[0];return e[1].test(t)});return e?e[0]:null}function getNodeVersion(){return"undefined"!=typeof process&&process.version?new NodeInfo(process.version.slice(1)):null}var now=function(){return+new Date},supportsRequestIdleCallback_="function"==typeof window.requestIdleCallback,IdleDealine=function(){function t(t){this.initTime_=t}return Object.defineProperty(t.prototype,"didTimeout",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.timeRemaining=function(){return Math.max(0,50-(now()-this.initTime_))},t}(),requestIdleCallbackShim=function(t){var e=new IdleDealine(now());return setTimeout(function(){return t(e)},0)},cancelIdleCallbackShim=function(t){clearTimeout(t)},rIC=supportsRequestIdleCallback_?window.requestIdleCallback:requestIdleCallbackShim,cIC=supportsRequestIdleCallback_?window.cancelIdleCallback:cancelIdleCallbackShim,createQueueMicrotaskViaPromises=function(){return function(t){Promise.resolve().then(t)}},createQueueMicrotaskViaMutationObserver=function(){var t=0,e=[],i=new MutationObserver(function(){e.forEach(function(t){return t()}),e=[]}),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(i){e.push(i),n.data=String(++t%2)}},queueMicrotask="function"==typeof Promise&&Promise.toString().indexOf("[native code]")>-1?createQueueMicrotaskViaPromises():createQueueMicrotaskViaMutationObserver(),DEFAULT_MIN_TASK_TIME=0,isSafari_=!("object"!=typeof window.safari||!window.safari.pushNotification),IdleQueue=function(){function t(t){var e=void 0===t?{}:t,i=e.ensureTasksRun,n=void 0!==i&&i,r=e.defaultMinTaskTime,s=void 0===r?DEFAULT_MIN_TASK_TIME:r;this.taskQueue_=[],this.isProcessing_=!1,this.state_=null,this.idleCallbackHandle_=null,this.taskQueue_=[],this.isProcessing_=!1,this.state_=null,this.defaultMinTaskTime_=s,this.ensureTasksRun_=n,this.runTasksImmediately=this.runTasksImmediately.bind(this),this.runTasks_=this.runTasks_.bind(this),this.onVisibilityChange_=this.onVisibilityChange_.bind(this),this.ensureTasksRun_&&(addEventListener("visibilitychange",this.onVisibilityChange_,!0),isSafari_&&addEventListener("beforeunload",this.runTasksImmediately,!0))}return t.prototype.pushTask=function(t){this.addTask_(Array.prototype.push,t)},t.prototype.unshiftTask=function(t){this.addTask_(Array.prototype.unshift,t)},t.prototype.runTasksImmediately=function(){this.runTasks_()},t.prototype.hasPendingTasks=function(){return this.taskQueue_.length>0},t.prototype.clearPendingTasks=function(){this.taskQueue_=[],this.cancelScheduledRun_()},t.prototype.getState=function(){return this.state_},t.prototype.destroy=function(){this.taskQueue_=[],this.cancelScheduledRun_(),this.ensureTasksRun_&&(removeEventListener("visibilitychange",this.onVisibilityChange_,!0),isSafari_&&removeEventListener("beforeunload",this.runTasksImmediately,!0))},t.prototype.addTask_=function(t,e,i){var n=(void 0===i?{}:i).minTaskTime,r=void 0===n?this.defaultMinTaskTime_:n,s={time:now(),visibilityState:document.visibilityState};t.call(this.taskQueue_,{state:s,task:e,minTaskTime:r}),this.scheduleTasksToRun_()},t.prototype.scheduleTasksToRun_=function(){this.ensureTasksRun_&&"hidden"===document.visibilityState?queueMicrotask(this.runTasks_):this.idleCallbackHandle_||(this.idleCallbackHandle_=rIC(this.runTasks_))},t.prototype.runTasks_=function(t){if(this.cancelScheduledRun_(),!this.isProcessing_){for(this.isProcessing_=!0;this.hasPendingTasks()&&!shouldYield(t,this.taskQueue_[0].minTaskTime);){var e=this.taskQueue_.shift(),i=e.task,n=e.state;this.state_=n,i(n),this.state_=null}this.isProcessing_=!1,this.hasPendingTasks()&&this.scheduleTasksToRun_()}},t.prototype.cancelScheduledRun_=function(){cIC(this.idleCallbackHandle_),this.idleCallbackHandle_=null},t.prototype.onVisibilityChange_=function(){"hidden"===document.visibilityState&&this.runTasksImmediately()},t}(),shouldYield=function(t,e){return!!(t&&t.timeRemaining()<=e)},EmulatedPerformance=function(){function t(t){this.config=t}return t.prototype.now=function(){return Date.now()/1e3},t.prototype.mark=function(t,e){},t.prototype.measure=function(t,e){return this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){var e=this;setTimeout(function(){t(e.getFirstPaint())})},t.prototype.getDurationByMetric=function(t,e){return e.end-e.start||0},t.prototype.getFirstPaint=function(){var t=window.performance.timing,e={duration:0,entryType:"paint",name:"first-contentful-paint",startTime:0};return t&&0!==t.navigationStart&&(e.startTime=Date.now()-t.navigationStart),[e]},t}(),Performance=function(){function t(t){this.config=t}return t.supported=function(){return window.performance&&!!performance.now&&!!performance.mark},t.supportedPerformanceObserver=function(){return window.chrome&&"PerformanceObserver"in window},t.prototype.now=function(){return window.performance.now()},t.prototype.mark=function(t,e){var i="mark_"+t+"_"+e;window.performance.mark(i)},t.prototype.measure=function(t,e){var i="mark_"+t+"_start",n="mark_"+t+"_end";return window.performance.measure(t,i,n),this.getDurationByMetric(t,e)},t.prototype.firstContentfulPaint=function(t){this.perfObserver=new PerformanceObserver(this.performanceObserverCb.bind(this,t)),this.perfObserver.observe({entryTypes:["paint"]})},t.prototype.getDurationByMetric=function(t,e){var i=this.getMeasurementForGivenName(t);return i&&"measure"===i.entryType?i.duration:-1},t.prototype.getMeasurementForGivenName=function(t){var e=window.performance.getEntriesByName(t);return e[e.length-1]},t.prototype.performanceObserverCb=function(t,e){var i=this,n=e.getEntries();t(n),n.forEach(function(t){i.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&i.perfObserver.disconnect()})},t}(),Perfume=function(){function t(t){void 0===t&&(t={});var e=this;this.config={firstContentfulPaint:!1,firstPaint:!1,firstInputDelay:!1,googleAnalytics:{enable:!1,timingVar:"name"},browserTracker:!1,logPrefix:"Perfume.js:",logging:!0,maxMeasureTime:15e3,warning:!1,debugging:!1},this.firstPaintDuration=0,this.firstContentfulPaintDuration=0,this.firstInputDelayDuration=0,this.isHidden=!1,this.logMetricWarn="Please provide a metric name",this.metrics=new Map,this.observers=new Map,this.didVisibilityChange=function(){document.hidden&&(e.isHidden=document.hidden)},this.config=Object.assign({},this.config,t),this.perf=Performance.supported()?new Performance(this.config):new EmulatedPerformance(this.config),this.config.browserTracker&&(this.browser=detect()),Performance.supportedPerformanceObserver()||(this.perfEmulated=new EmulatedPerformance(this.config)),(this.config.firstPaint||this.config.firstContentfulPaint)&&(this.observeFirstContentfulPaint=new Promise(function(t){e.logDebug("observeFirstContentfulPaint"),e.observers.set("fcp",t),e.initFirstPaint()})),this.config.firstInputDelay&&(this.observeFirstInputDelay=new Promise(function(t){e.observers.set("fid",t),e.initFirstInputDelay()})),this.onVisibilityChange(),this.queue=new IdleQueue({ensureTasksRun:!0})}return t.prototype.start=function(t){this.checkMetricName(t)&&(this.metrics.has(t)?this.logWarn(this.config.logPrefix,"Recording already started."):(this.metrics.set(t,{end:0,start:this.perf.now()}),this.perf.mark(t,"start"),this.isHidden=!1))},t.prototype.end=function(e,i){var t=e;i&&i.didCancel?t="CANCELLED:"+e:i&&i.didFail&&(t="FAILED:"+e);var r=this;if(this.checkMetricName(e)){var s=this.metrics.get(e);if(s){s.end=this.perf.now(),this.perf.mark(e,"end");var a=this.perf.measure(e,s),n=parseFloat(a.toFixed(2));return this.metrics.delete(e),this.queue.pushTask(function(){r.log(t,n),r.sendTiming(t,n)}),n}this.logWarn(this.config.logPrefix,"Recording already stopped.")}},t.prototype.endPaint=function(t){var e=this;return new Promise(function(i){setTimeout(function(){var n=e.end(t);i(n)})})},t.prototype.log=function(t,e){if(!this.isHidden&&this.config.logging)if(t){var i=e.toFixed(2),n="%c "+this.config.logPrefix+" "+t+" "+i+" ms";window.console.log(n,"color: #ff6d00;font-size:11px;")}else this.logWarn(this.config.logPrefix,this.logMetricWarn)},t.prototype.logDebug=function(t,e){void 0===e&&(e=""),this.config.debugging&&window.console.log("Perfume.js debugging "+t+":",e)},t.prototype.sendTiming=function(t,e){if(!this.isHidden){var i=this.config.browserTracker?this.browser:void 0,n=this.addBrowserToMetricName(t);if(this.config.analyticsTracker&&this.config.analyticsTracker(t,e,i),this.config.googleAnalytics.enable)if(window.ga){var r=Math.round(e);window.ga("send","timing",n,this.config.googleAnalytics.timingVar,r)}else this.logWarn(this.config.logPrefix,"Google Analytics has not been loaded")}},t.prototype.addBrowserToMetricName=function(t){if(!this.config.browserTracker)return t;var e=t;this.browser.name&&(e+="."+this.browser.name.replace(/\s/g,""),this.browser.os&&(e+="."+this.browser.os.replace(/\s/g,"")));return e},t.prototype.checkMetricName=function(t){return!!t||(this.logWarn(this.config.logPrefix,this.logMetricWarn),!1)},t.prototype.firstContentfulPaintCb=function(t){var e=this;this.logDebug("firstContentfulPaintCb",t),t.forEach(function(t){e.queue.pushTask(function(){e.config.firstPaint&&"first-paint"===t.name&&e.logMetric(t.startTime,"First Paint","firstPaint"),e.config.firstContentfulPaint&&"first-contentful-paint"===t.name&&e.logMetric(t.startTime,"First Contentful Paint","firstContentfulPaint")})})},t.prototype.initFirstPaint=function(){if(this.logDebug("initFirstPaint"),Performance.supportedPerformanceObserver()){this.logDebug("initFirstPaint.supportedPerformanceObserver");try{this.perf.firstContentfulPaint(this.firstContentfulPaintCb.bind(this))}catch(t){this.logWarn(this.config.logPrefix,"initFirstPaint failed")}}else this.perfEmulated&&(this.logDebug("initFirstPaint.perfEmulated"),this.perfEmulated.firstContentfulPaint(this.firstContentfulPaintCb.bind(this)))},t.prototype.initFirstInputDelay=function(){var t=this;Performance.supported()&&this.config.firstInputDelay&&perfMetrics.onFirstInputDelay(function(e,i){t.queue.pushTask(function(){t.logMetric(e,"First Input Delay","firstInputDelay")})})},t.prototype.onVisibilityChange=function(){void 0!==document.hidden&&document.addEventListener("visibilitychange",this.didVisibilityChange)},t.prototype.logMetric=function(t,e,i){var n=parseFloat(t.toFixed(2));n>this.config.maxMeasureTime||("firstPaint"===i&&(this.firstPaintDuration=n),"firstContentfulPaint"===i&&(this.firstContentfulPaintDuration=n,this.observers.get("fcp")(n)),"firstInputDelay"===i&&(this.firstInputDelayDuration=n,this.observers.get("fid")(n)),this.log(e,n),this.sendTiming(i,n))},t.prototype.logWarn=function(t,e){this.config.warning&&this.config.logging&&window.console.warn(t,e)},t}();export default Perfume;
 //# sourceMappingURL=perfume.es5.min.js.map
